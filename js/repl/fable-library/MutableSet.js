import{disposeSafe,defaultOf,partialApply,toIterator,getEnumerator}from"./Util.js";import{iterate,map,iterateIndexed,concat}from"./Seq.js";import{FSharpRef}from"./Types.js";import{class_type}from"./Reflection.js";import{getItemFromDict,tryGetValue}from"./MapUtil.js";import{some}from"./Option.js";export class HashSet{constructor(e,t){const r=new FSharpRef(defaultOf());this.comparer=t,r.contents=this,this.hashMap=new Map([]),this["init@9"]=1;const n=getEnumerator(e);try{for(;n["System.Collections.IEnumerator.MoveNext"]();){const e=n["System.Collections.Generic.IEnumerator`1.get_Current"]();HashSet__Add_2B595(r.contents,e)}}finally{disposeSafe(n)}}get[Symbol.toStringTag](){return"HashSet"}toJSON(){return Array.from(this)}"System.Collections.IEnumerable.GetEnumerator"(){return getEnumerator(this)}GetEnumerator(){return getEnumerator(concat(this.hashMap.values()))}[Symbol.iterator](){return toIterator(this.GetEnumerator())}"System.Collections.Generic.ICollection`1.Add2B595"(e){HashSet__Add_2B595(this,e)}"System.Collections.Generic.ICollection`1.Clear"(){HashSet__Clear(this)}"System.Collections.Generic.ICollection`1.Contains2B595"(e){return HashSet__Contains_2B595(this,e)}"System.Collections.Generic.ICollection`1.CopyToZ3B4C077E"(e,t){iterateIndexed(((r,n)=>{e[t+r]=n}),this)}"System.Collections.Generic.ICollection`1.get_Count"(){return 0|HashSet__get_Count(this)}"System.Collections.Generic.ICollection`1.get_IsReadOnly"(){return!1}"System.Collections.Generic.ICollection`1.Remove2B595"(e){return HashSet__Remove_2B595(this,e)}get size(){return 0|HashSet__get_Count(this)}add(e){return HashSet__Add_2B595(this,e),this}clear(){HashSet__Clear(this)}delete(e){return HashSet__Remove_2B595(this,e)}has(e){return HashSet__Contains_2B595(this,e)}keys(){return map((e=>e),this)}values(){return map((e=>e),this)}entries(){return map((e=>[e,e]),this)}forEach(e,t){const r=this;iterate((t=>{partialApply(2,e,[t])(t)(r)}),r)}}export function HashSet$reflection(e){return class_type("Fable.Collections.HashSet",[e],HashSet)}export function HashSet_$ctor_Z6150332D(e,t){return new HashSet(e,t)}function HashSet__TryFindIndex_2B595(e,t){const r=0|e.comparer.GetHashCode(t);let n,s=defaultOf();return n=[tryGetValue(e.hashMap,r,new FSharpRef((()=>s),(e=>{s=e}))),s],n[0]?[!0,r,n[1].findIndex((r=>e.comparer.Equals(t,r)))]:[!1,r,-1]}function HashSet__TryFind_2B595(e,t){const r=HashSet__TryFindIndex_2B595(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return some(getItemFromDict(e.hashMap,r[1])[r[2]]);case 1:return}}export function HashSet__get_Comparer(e){return e.comparer}export function HashSet__Clear(e){e.hashMap.clear()}export function HashSet__get_Count(e){let t=0,r=getEnumerator(e.hashMap.values());try{for(;r["System.Collections.IEnumerator.MoveNext"]();)t=t+r["System.Collections.Generic.IEnumerator`1.get_Current"]().length|0}finally{disposeSafe(r)}return 0|t}export function HashSet__Add_2B595(e,t){const r=HashSet__TryFindIndex_2B595(e,t);return r[0]?!(r[2]>-1)&&(getItemFromDict(e.hashMap,r[1]).push(t),!0):(e.hashMap.set(r[1],[t]),!0)}export function HashSet__Contains_2B595(e,t){const r=HashSet__TryFindIndex_2B595(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return!0;case 1:return!1}}export function HashSet__Remove_2B595(e,t){const r=HashSet__TryFindIndex_2B595(e,t);let n;switch(n=r[0]&&r[2]>-1?0:1,n){case 0:return getItemFromDict(e.hashMap,r[1]).splice(r[2],1),!0;case 1:return!1}}